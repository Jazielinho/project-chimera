## Model summary (torchinfo)

```
===================================================================================================================================================================================================
Layer (type (var_name))                       Kernel Shape              Input Shape               Output Shape              Param #                   Mult-Adds                 Trainable
===================================================================================================================================================================================================
ImageEncoder (ImageEncoder)                   --                        [1, 3, 224, 224]          [1, 256]                  --                        --                        Partial
├─ResNet (backbone)                           --                        [1, 3, 224, 224]          [1, 512]                  --                        --                        False
│    └─Conv2d (conv1)                         [7, 7]                    [1, 3, 224, 224]          [1, 64, 112, 112]         (9,408)                   118,013,952               False
│    └─BatchNorm2d (bn1)                      --                        [1, 64, 112, 112]         [1, 64, 112, 112]         (128)                     128                       False
│    └─ReLU (act1)                            --                        [1, 64, 112, 112]         [1, 64, 112, 112]         --                        --                        --
│    └─MaxPool2d (maxpool)                    3                         [1, 64, 112, 112]         [1, 64, 56, 56]           --                        --                        --
│    └─Sequential (layer1)                    --                        [1, 64, 56, 56]           [1, 64, 56, 56]           --                        --                        False
│    │    └─BasicBlock (0)                    --                        [1, 64, 56, 56]           [1, 64, 56, 56]           --                        --                        False
│    │    │    └─Conv2d (conv1)               [3, 3]                    [1, 64, 56, 56]           [1, 64, 56, 56]           (36,864)                  115,605,504               False
│    │    │    └─BatchNorm2d (bn1)            --                        [1, 64, 56, 56]           [1, 64, 56, 56]           (128)                     128                       False
│    │    │    └─Identity (drop_block)        --                        [1, 64, 56, 56]           [1, 64, 56, 56]           --                        --                        --
│    │    │    └─ReLU (act1)                  --                        [1, 64, 56, 56]           [1, 64, 56, 56]           --                        --                        --
│    │    │    └─Identity (aa)                --                        [1, 64, 56, 56]           [1, 64, 56, 56]           --                        --                        --
│    │    │    └─Conv2d (conv2)               [3, 3]                    [1, 64, 56, 56]           [1, 64, 56, 56]           (36,864)                  115,605,504               False
│    │    │    └─BatchNorm2d (bn2)            --                        [1, 64, 56, 56]           [1, 64, 56, 56]           (128)                     128                       False
│    │    │    └─ReLU (act2)                  --                        [1, 64, 56, 56]           [1, 64, 56, 56]           --                        --                        --
│    │    └─BasicBlock (1)                    --                        [1, 64, 56, 56]           [1, 64, 56, 56]           --                        --                        False
│    │    │    └─Conv2d (conv1)               [3, 3]                    [1, 64, 56, 56]           [1, 64, 56, 56]           (36,864)                  115,605,504               False
│    │    │    └─BatchNorm2d (bn1)            --                        [1, 64, 56, 56]           [1, 64, 56, 56]           (128)                     128                       False
│    │    │    └─Identity (drop_block)        --                        [1, 64, 56, 56]           [1, 64, 56, 56]           --                        --                        --
│    │    │    └─ReLU (act1)                  --                        [1, 64, 56, 56]           [1, 64, 56, 56]           --                        --                        --
│    │    │    └─Identity (aa)                --                        [1, 64, 56, 56]           [1, 64, 56, 56]           --                        --                        --
│    │    │    └─Conv2d (conv2)               [3, 3]                    [1, 64, 56, 56]           [1, 64, 56, 56]           (36,864)                  115,605,504               False
│    │    │    └─BatchNorm2d (bn2)            --                        [1, 64, 56, 56]           [1, 64, 56, 56]           (128)                     128                       False
│    │    │    └─ReLU (act2)                  --                        [1, 64, 56, 56]           [1, 64, 56, 56]           --                        --                        --
│    └─Sequential (layer2)                    --                        [1, 64, 56, 56]           [1, 128, 28, 28]          --                        --                        False
│    │    └─BasicBlock (0)                    --                        [1, 64, 56, 56]           [1, 128, 28, 28]          --                        --                        False
│    │    │    └─Conv2d (conv1)               [3, 3]                    [1, 64, 56, 56]           [1, 128, 28, 28]          (73,728)                  57,802,752                False
│    │    │    └─BatchNorm2d (bn1)            --                        [1, 128, 28, 28]          [1, 128, 28, 28]          (256)                     256                       False
│    │    │    └─Identity (drop_block)        --                        [1, 128, 28, 28]          [1, 128, 28, 28]          --                        --                        --
│    │    │    └─ReLU (act1)                  --                        [1, 128, 28, 28]          [1, 128, 28, 28]          --                        --                        --
│    │    │    └─Identity (aa)                --                        [1, 128, 28, 28]          [1, 128, 28, 28]          --                        --                        --
│    │    │    └─Conv2d (conv2)               [3, 3]                    [1, 128, 28, 28]          [1, 128, 28, 28]          (147,456)                 115,605,504               False
│    │    │    └─BatchNorm2d (bn2)            --                        [1, 128, 28, 28]          [1, 128, 28, 28]          (256)                     256                       False
│    │    │    └─Sequential (downsample)      --                        [1, 64, 56, 56]           [1, 128, 28, 28]          --                        --                        False
│    │    │    │    └─Conv2d (0)              [1, 1]                    [1, 64, 56, 56]           [1, 128, 28, 28]          (8,192)                   6,422,528                 False
│    │    │    │    └─BatchNorm2d (1)         --                        [1, 128, 28, 28]          [1, 128, 28, 28]          (256)                     256                       False
│    │    │    └─ReLU (act2)                  --                        [1, 128, 28, 28]          [1, 128, 28, 28]          --                        --                        --
│    │    └─BasicBlock (1)                    --                        [1, 128, 28, 28]          [1, 128, 28, 28]          --                        --                        False
│    │    │    └─Conv2d (conv1)               [3, 3]                    [1, 128, 28, 28]          [1, 128, 28, 28]          (147,456)                 115,605,504               False
│    │    │    └─BatchNorm2d (bn1)            --                        [1, 128, 28, 28]          [1, 128, 28, 28]          (256)                     256                       False
│    │    │    └─Identity (drop_block)        --                        [1, 128, 28, 28]          [1, 128, 28, 28]          --                        --                        --
│    │    │    └─ReLU (act1)                  --                        [1, 128, 28, 28]          [1, 128, 28, 28]          --                        --                        --
│    │    │    └─Identity (aa)                --                        [1, 128, 28, 28]          [1, 128, 28, 28]          --                        --                        --
│    │    │    └─Conv2d (conv2)               [3, 3]                    [1, 128, 28, 28]          [1, 128, 28, 28]          (147,456)                 115,605,504               False
│    │    │    └─BatchNorm2d (bn2)            --                        [1, 128, 28, 28]          [1, 128, 28, 28]          (256)                     256                       False
│    │    │    └─ReLU (act2)                  --                        [1, 128, 28, 28]          [1, 128, 28, 28]          --                        --                        --
│    └─Sequential (layer3)                    --                        [1, 128, 28, 28]          [1, 256, 14, 14]          --                        --                        False
│    │    └─BasicBlock (0)                    --                        [1, 128, 28, 28]          [1, 256, 14, 14]          --                        --                        False
│    │    │    └─Conv2d (conv1)               [3, 3]                    [1, 128, 28, 28]          [1, 256, 14, 14]          (294,912)                 57,802,752                False
│    │    │    └─BatchNorm2d (bn1)            --                        [1, 256, 14, 14]          [1, 256, 14, 14]          (512)                     512                       False
│    │    │    └─Identity (drop_block)        --                        [1, 256, 14, 14]          [1, 256, 14, 14]          --                        --                        --
│    │    │    └─ReLU (act1)                  --                        [1, 256, 14, 14]          [1, 256, 14, 14]          --                        --                        --
│    │    │    └─Identity (aa)                --                        [1, 256, 14, 14]          [1, 256, 14, 14]          --                        --                        --
│    │    │    └─Conv2d (conv2)               [3, 3]                    [1, 256, 14, 14]          [1, 256, 14, 14]          (589,824)                 115,605,504               False
│    │    │    └─BatchNorm2d (bn2)            --                        [1, 256, 14, 14]          [1, 256, 14, 14]          (512)                     512                       False
│    │    │    └─Sequential (downsample)      --                        [1, 128, 28, 28]          [1, 256, 14, 14]          --                        --                        False
│    │    │    │    └─Conv2d (0)              [1, 1]                    [1, 128, 28, 28]          [1, 256, 14, 14]          (32,768)                  6,422,528                 False
│    │    │    │    └─BatchNorm2d (1)         --                        [1, 256, 14, 14]          [1, 256, 14, 14]          (512)                     512                       False
│    │    │    └─ReLU (act2)                  --                        [1, 256, 14, 14]          [1, 256, 14, 14]          --                        --                        --
│    │    └─BasicBlock (1)                    --                        [1, 256, 14, 14]          [1, 256, 14, 14]          --                        --                        False
│    │    │    └─Conv2d (conv1)               [3, 3]                    [1, 256, 14, 14]          [1, 256, 14, 14]          (589,824)                 115,605,504               False
│    │    │    └─BatchNorm2d (bn1)            --                        [1, 256, 14, 14]          [1, 256, 14, 14]          (512)                     512                       False
│    │    │    └─Identity (drop_block)        --                        [1, 256, 14, 14]          [1, 256, 14, 14]          --                        --                        --
│    │    │    └─ReLU (act1)                  --                        [1, 256, 14, 14]          [1, 256, 14, 14]          --                        --                        --
│    │    │    └─Identity (aa)                --                        [1, 256, 14, 14]          [1, 256, 14, 14]          --                        --                        --
│    │    │    └─Conv2d (conv2)               [3, 3]                    [1, 256, 14, 14]          [1, 256, 14, 14]          (589,824)                 115,605,504               False
│    │    │    └─BatchNorm2d (bn2)            --                        [1, 256, 14, 14]          [1, 256, 14, 14]          (512)                     512                       False
│    │    │    └─ReLU (act2)                  --                        [1, 256, 14, 14]          [1, 256, 14, 14]          --                        --                        --
│    └─Sequential (layer4)                    --                        [1, 256, 14, 14]          [1, 512, 7, 7]            --                        --                        False
│    │    └─BasicBlock (0)                    --                        [1, 256, 14, 14]          [1, 512, 7, 7]            --                        --                        False
│    │    │    └─Conv2d (conv1)               [3, 3]                    [1, 256, 14, 14]          [1, 512, 7, 7]            (1,179,648)               57,802,752                False
│    │    │    └─BatchNorm2d (bn1)            --                        [1, 512, 7, 7]            [1, 512, 7, 7]            (1,024)                   1,024                     False
│    │    │    └─Identity (drop_block)        --                        [1, 512, 7, 7]            [1, 512, 7, 7]            --                        --                        --
│    │    │    └─ReLU (act1)                  --                        [1, 512, 7, 7]            [1, 512, 7, 7]            --                        --                        --
│    │    │    └─Identity (aa)                --                        [1, 512, 7, 7]            [1, 512, 7, 7]            --                        --                        --
│    │    │    └─Conv2d (conv2)               [3, 3]                    [1, 512, 7, 7]            [1, 512, 7, 7]            (2,359,296)               115,605,504               False
│    │    │    └─BatchNorm2d (bn2)            --                        [1, 512, 7, 7]            [1, 512, 7, 7]            (1,024)                   1,024                     False
│    │    │    └─Sequential (downsample)      --                        [1, 256, 14, 14]          [1, 512, 7, 7]            --                        --                        False
│    │    │    │    └─Conv2d (0)              [1, 1]                    [1, 256, 14, 14]          [1, 512, 7, 7]            (131,072)                 6,422,528                 False
│    │    │    │    └─BatchNorm2d (1)         --                        [1, 512, 7, 7]            [1, 512, 7, 7]            (1,024)                   1,024                     False
│    │    │    └─ReLU (act2)                  --                        [1, 512, 7, 7]            [1, 512, 7, 7]            --                        --                        --
│    │    └─BasicBlock (1)                    --                        [1, 512, 7, 7]            [1, 512, 7, 7]            --                        --                        False
│    │    │    └─Conv2d (conv1)               [3, 3]                    [1, 512, 7, 7]            [1, 512, 7, 7]            (2,359,296)               115,605,504               False
│    │    │    └─BatchNorm2d (bn1)            --                        [1, 512, 7, 7]            [1, 512, 7, 7]            (1,024)                   1,024                     False
│    │    │    └─Identity (drop_block)        --                        [1, 512, 7, 7]            [1, 512, 7, 7]            --                        --                        --
│    │    │    └─ReLU (act1)                  --                        [1, 512, 7, 7]            [1, 512, 7, 7]            --                        --                        --
│    │    │    └─Identity (aa)                --                        [1, 512, 7, 7]            [1, 512, 7, 7]            --                        --                        --
│    │    │    └─Conv2d (conv2)               [3, 3]                    [1, 512, 7, 7]            [1, 512, 7, 7]            (2,359,296)               115,605,504               False
│    │    │    └─BatchNorm2d (bn2)            --                        [1, 512, 7, 7]            [1, 512, 7, 7]            (1,024)                   1,024                     False
│    │    │    └─ReLU (act2)                  --                        [1, 512, 7, 7]            [1, 512, 7, 7]            --                        --                        --
│    └─SelectAdaptivePool2d (global_pool)     --                        [1, 512, 7, 7]            [1, 512]                  --                        --                        --
│    │    └─AdaptiveAvgPool2d (pool)          --                        [1, 512, 7, 7]            [1, 512, 1, 1]            --                        --                        --
│    │    └─Flatten (flatten)                 --                        [1, 512, 1, 1]            [1, 512]                  --                        --                        --
│    └─Identity (fc)                          --                        [1, 512]                  [1, 512]                  --                        --                        --
├─Sequential (projection)                     --                        [1, 512]                  [1, 256]                  --                        --                        True
│    └─Linear (0)                             --                        [1, 512]                  [1, 256]                  131,328                   131,328                   True
│    └─LayerNorm (1)                          --                        [1, 256]                  [1, 256]                  512                       512                       True
===================================================================================================================================================================================================
Total params: 11,308,352
Trainable params: 131,840
Non-trainable params: 11,176,512
Total mult-adds (G): 1.81
===================================================================================================================================================================================================
Input size (MB): 0.60
Forward/backward pass size (MB): 39.74
Params size (MB): 45.23
Estimated Total Size (MB): 85.58
===================================================================================================================================================================================================
```